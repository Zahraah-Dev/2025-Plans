# **1\) الهيكلة (Architecture)**

*  نمط معماري واحد ومعلن (مثلاً **Feature-first \+ Clean Architecture** أو **BLoC/Riverpod \+ Repository**)، ومكتوب في ملف `ARCHITECTURE.md`.  
*  فصل صارم بين الطبقات: Presentation / Domain / Data. ما في استدعاءات شبكة من الـWidgets.  
*  اعتماد **Repository** واجهات (abstract) وتطبيقات (impl)، وسهولة استبدال المصادر (API، كاش محلي) بالـDI.

# **2\) هيكلة المشروع والأسماء**

*  تنظيم بالمزايا (feature-first):  
  `features/checkout`, `features/catalog`, `features/auth` … وكل ميزة فيها `presentation/`, `domain/`, `data/`.  
*  أسماء ملفات/كلاسات موحدة (snake\_case للملفات، PascalCase للكلاسات)، ملف واحد لكل كلاس.  
*  لا توجد مجلدات “misc/utils” عشوائية—كل أداة تابعة لميزة أو لمجلد core مشروح.

# **3\) حالة التطبيق (State Management)**

*  اختيار إطار واحد واضح (مثلاً **Riverpod** أو **BLoC**) مع دليل استخدام داخلي.  
*  الحالة مشتقة/قابلة للاختبار، بدون تمرير context غير ضروري.  
*  منع إعادة البناء الزائدة (selectors, providers granular, const widgets، مفاتيح Keys صحيحة).

# **4\) التصفّح (Navigation)**

*  راوتر حديث (مثل GoRouter) مع تعريف مسارات مركزي وحماية (guards) لتوثيق/صلاحيات.  
*  Deep Links & Dynamic Links تعمل ومختبرة على iOS/Android.  
*  مخطط تنقل موثق (flow diagrams لصفحات حرجة مثل الدفع).

# **5\) طبقة البيانات والشبكة**

*  دوال شبكة عبر عميل مركزي (Dio/Retrofit مثلاً) مع **timeouts**, **retry**, **circuit breaker** بسيط.  
*  نماذج بيانات مولّدة (json\_serializable/freezed) بدون parsing يدوي.  
*  كاش محلي منظّم (Hive/Isar/Drift) بسياسة صلاحية (TTL) واضحة.

# **6\) التصميم والـUI**

*  **Design System** موحد: Theme, ColorScheme, Typography, Spacings, Components مخصصة.  
*  عناصر UI قابلة لإعادة الاستخدام (Buttons, Inputs, Cards) ضمن `shared/ui` أو `core/ui`.  
*  **RTL** مفعل ومختبَر (العربية)، أحجام خطوط تستجيب لتكبير النص.

# **7\) الأداء (Performance)**

*  أول إطارات الرسم **\< 2 ثوانٍ** على جهاز متوسط، ومعدل jank \< **1%** في شاشات طويلة التمرير.  
*  صور مضغوطة ومسبقة التحميل عند الحاجة، و`const` قدر الإمكان، وتجنّب العمليات الثقيلة على الـUI thread.  
*  استخدام `flutter build appbundle --analyze-size` دوريًا ومتابعة النمو.

# **8\) الموثوقية والأخطاء**

*  طبقة أخطاء موحدة (AppException) مع خرائط رسائل ودلالات أكواد HTTP.  
*  تسجيل Logs منظّم (logger/Sentry) مع معرّف للجلسة والمستخدم (بدون بيانات حساسة).  
*  شاشة/حالة fallback لكل خطأ (شبكة ضعيفة، انتهاء جلسة، 404)، و**Retry UX** واضح.

# **9\) الأمان والخصوصية**

*  أسرار وKeys خارج الكود (dart-define، أو إدارة أسرار CI). لا أسرار في Git.  
*  تشفير مخزن محلي للحساس (tokens) واستخدام Keystore/Keychain.  
*  سياسة تتبع وخصوصية واضحة، وإيقاف جمع Analytics عند طلب المستخدم.

# **10\) التحليلات والقياس (مهم لتطبيقك)**

*  قاموس أحداث موحد `analytics_events.md` (أسماء ثابتة، snake\_case، مع معايير: من أين أتى المستخدم؟ ماذا ضغط؟).  
*  تتبع مسار الشراء كاملاً: عرض منتج ⇒ إضافة للسلة ⇒ بدء الدفع ⇒ اختيار طريقة الدفع ⇒ تأكيد الطلب.  
*  تعريف أبعاد ثابتة (user\_id, cohort, app\_version, channel) ومراجعة جودة البيانات شهريًا.

# **11\) الجودة والاختبارات**

*  Linters مفعلة (flutter\_lints أو very\_good\_analysis) و**صفر** تحذير في `flutter analyze`.  
*  تغطية اختبارات **≥ 70%** لوحدات المنطق، مع **Widget tests** للشاشات الحرجة، و**Integration tests** لتدفق الشراء.  
*  **Golden tests** للمكونات البصرية الأساسية لضمان ثبات التصميم.

# **12\) الإصدارات وCI/CD**

*  Flavors: dev/stage/prod، مع ملفات Firebase منفصلة لكل بيئة.  
*  **CI** يشغّل: format \+ analyze \+ tests \+ build لكل PR؛ **CD** يبني النسخ التجريبية تلقائيًا.  
*  ترقيم إصدارات واضح (Semantic Versioning) و`CHANGELOG.md` مختصر لكل إصدار.

# **13\) الإشعارات والروابط والميزات الخاصة بالتجارة**

*  Push notifications عبر خدمة موحدة (FCM) مع قنوات Android وقابلة للنقر إلى الشاشات المناسبة (deep link).  
*  معالجة الدفع/الدفع عند الاستلام UX نظيف، وسياسة فشل محاولة الدفع واضحة.  
*  الاسترجاع/الإرجاع/التوصيل مدمج UX مع تتبع حالة الطلب داخل التطبيق.

---

## **فحص سريع (90 دقيقة) لتقييم الوضع الحالي**

نفّذ هذه الخطوات وسجّل النتائج كنقاط “نجاح/فشل”:

1. **كود وانضباط**  
* شغّل:  
  `dart format --set-exit-if-changed .` (لا تغييرات \= ✔️)  
  `flutter analyze` (0 تحذيرات/أخطاء \= ✔️)  
* افتح `pubspec.yaml`: لا توجد مكتبات مكررة/قديمة بشكل خطير، وكل الإصدارات محددة.  
2. **الاختبارات**  
* `flutter test --coverage` (تحقّق ≥ 70% \= ✔️، وإلا حدّد الملفّات الأضعف وضع خطة رفع).  
3. **الأداء**  
* شغّل في **profile mode** وجرب أهم 3 شاشات (الرئيسية/القسم/الدفع).  
  راقب jank في DevTools، وحجم build عبر `--analyze-size`.  
4. **البناء والتوزيع**  
* جرّب بناء flavors المختلفة بنجاح (dev/stage/prod).  
  تأكد أن مفاتيح Firebase/SDKs الصحيحة تُسحب حسب البيئة.  
5. **التحليلات**  
* افتح Firebase/GA4: تأكّد أن الأحداث الأساسية تصل وبالأبعاد المتفق عليها، ولا توجد أسماء عشوائية.  
6. **الأمان**  
* افحص المستودع بحثًا عن أسرار (`google-services.json`/`plist` حساسة؟ مفاتيح مكشوفة؟).  
  تأكد من تخزين tokens مشفّر محليًا.  
7. **الـUX وRTL**  
* اختبر **تكبير الخط** و**العربية RTL** في 3–4 شاشات، وتأكد من خلوّ الانعكاسات/القص.

---

## **قائمة مراجعة لكل Pull Request (انسخها للفريق)**

*  شرح التغيير ولقطات شاشة/فيديو قبل/بعد (لو UI).  
*  تغطية اختبارات مضافة أو محدّثة.  
*  لا كسر للـAPI الداخلي—أو موثق في CHANGELOG.  
*  `flutter analyze` و`flutter test` ناجحة.  
*  لا استيراد متقاطع بين الميزات (احترام الطبقات).  
*  أحداث Analytics مضافة/محدّثة حسب القاموس.  
*  فحص أداء سريع (عدم وجود setState كثيف/بُنَى ثقيلة في build).  
*  لقطات RTL والتحجيم (إن لزم).

---

## **مؤشرات “خطر” لو ظهرت عندك أصلّح فورًا**

* أكواد شبكة داخل Widgets أو Cubits/Notifiers تتصل مباشرة بدون Repository.  
* Utils عملاقة “تفعل كل شيء”.  
* تعدد أنماط إدارة الحالة في نفس المشروع بدون سبب.  
* غياب الاختبارات تمامًا.  
* أسرار داخل الكود أو في Git.  
* Theme غير موحد ومكونات متكررة عن غير حاجة.


---

## 🏠 **Back to Home | العودة للرئيسية**

[← Back to Main Index | العودة للفهرس الرئيسي](../../../index.html)

---
