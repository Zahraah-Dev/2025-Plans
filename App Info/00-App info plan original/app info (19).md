---

# **إرشادات عند استخدام المكاتب (Libraries/Packages)**

## **1\. اختيار المكتبات**

* **الاعتماد على المكاتب الرسمية والمجتمعية الموثوقة فقط** (مثل: `flutter_bloc`، `riverpod`، `dio`، `go_router`).  
* **تجنّب المكاتب الصغيرة أو غير المحدثة** (آخر تحديث قبل أكثر من 12 شهر \= خطر أمني/توافق).  
* تحقق من **عدد التنزيلات \+ معدل الصيانة** في pub.dev قبل الإضافة.  
* **لا تُستخدم مكتبات خارجية** إذا كان يمكن إنجاز الوظيفة بكود بسيط داخليًا (لتقليل الاعتمادية).

## **2\. إدارة الإصدارات**

* جميع المكاتب يجب أن تُثبت بنسخة محددة (pinning) داخل `pubspec.yaml` وليس باستخدام `any`.  
* يتم **مراجعة التوافق** مع Flutter SDK قبل الترقية.  
* لا يُسمح بتحديث مكتبة في فرع التطوير إلا عبر **PR مستقل** \+ مراجعة.

## **3\. المعمارية والتقسيم**

* **لا استدعاء مباشر من الـUI لأي مكتبة خارجية**.  
  * الشبكات: عبر طبقة Data فقط (مثال: `dio` داخل `api_service`).  
  * التخزين: عبر Repository/Cache layer (مثال: `shared_preferences` أو `hive`).  
* **تجريد (abstraction)**: كل مكتبة تُغلف داخل Service أو Helper class.  
  * مثال: لا يُكتب `FirebaseAnalytics.instance.logEvent` في الكود مباشرة، بل داخل `AnalyticsService.logEvent()`.

## **4\. التوثيق والالتزام**

* عند إضافة مكتبة جديدة:  
  * تحديث ملف `ARCHITECTURE.md` بذكر اسم المكتبة \+ الغرض منها \+ مكان استخدامها.  
  * إضافة مثال صغير (usage snippet) داخل دليل المطورين.  
* أي مكتبة لا تُوثّق لا يُسمح باستخدامها.

## **5\. الأداء والوزن**

* يُمنع إضافة مكتبة تزيد حجم التطبيق بشكل كبير (خصوصًا مكتبات UI ضخمة).  
* قبل اعتماد مكتبة، يجب اختبار أثرها على حجم الـAAB باستخدام `flutter build appbundle --analyze-size`.  
* إذا كانت مكتبة توفر أكثر من وظيفة، ولا تحتاج إلا جزءًا منها → ابحث عن مكتبة أصغر أو اعمل implementation داخلي.

## **6\. الأمان والخصوصية**

* لا استخدام مكتبات غير موثوقة تتعامل مع **البيانات الحساسة** (توكنات، معلومات مستخدم، بيانات دفع).  
* عند استخدام Firebase/Analytics/Crashlytics → يجب تفعيل **إخفاء بيانات PII** (مثل البريد والهاتف) أو تخزينها بشكل مشفر.  
* مكتبات التواصل مع السيرفر يجب أن تعمل فقط عبر **HTTPS \+ TLS** (ويُفضل SSL Pinning).

## **7\. الصيانة والاختبارات**

* كل مكتبة جديدة يجب أن تكون **مغطاة باختبارات** أو Mock (مثلاً mock لـ Dio في اختبار الشبكات).  
* لا يُسمح بربط المكتبة مباشرة في الاختبارات → استخدم واجهة مجردة (interface).

---

# **توجية**

* **المسموح**:  
  * `dio` (شبكات) → يُستخدم داخل `network_service.dart` فقط.  
  * `riverpod` (state management) → عبر Providers، بدون خلط داخل Widgets.  
  * `go_router` (navigation) → داخل ملف Routing المركزي فقط.  
* **الممنوع**:  
  * استخدام `http` \+ `dio` معًا.  
  * مناداة Firebase مباشرة من Widgets.  
  * إدخال مكتبة لغرض تجريبي بدون توثيق.


---

## 🏠 **Back to Home | العودة للرئيسية**

[← Back to Main Index | العودة للفهرس الرئيسي](../../../index.html)

---
